<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>dBUMfit @ dnet 1.0.6</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dnet 1.0.6</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="rdata.html"><i class="icon-file icon-white"></i> RData</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="faqs.html"><i class="icon-question-sign icon-white"></i> FAQs</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
       
        <!-- HTML for GOOLE SEARCH BAR 
        <ul class="nav">
            <div id="search-wrapper">
                <form id="search" method="get" action="http://www.google.com/custom">
                    <div class="search-box">
                        <i class="icon-search icon-white"></i>
                        <input type="text" id="tfq" class="textinput" name="q" size="21" maxlength="120" value="Google Search"/>
                    </div>
                </form>
            </div>
        </ul>
        -->
        
      </div>
    </div>
  </div>
</div>

<!-- CSS styles for standard search box with placeholder text-->
<style type="text/css">
    #search-wrapper {
        width:300px;
        height:40px;
        background-color:transparent;
        margin:0px auto 0;
        border:0px solid #ff0000;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

    #search {
        background-color:transparent;
        padding:0px;
        height:40px;
        overflow:hidden;
    }

    .search-box {
        width:250px;
        height:32px;
        background-color:transparent;
        margin:2px 7px;
        border:0px solid #cfcfcf;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

	.textinput{
		margin: 0;
		padding: 5px 15px;
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
		color:#999999;
		border:1px solid #f00; border-right:0px;
		border-top-left-radius: 5px 5px;
		border-bottom-left-radius: 5px 5px;
	}
</style>

<!-- JAVASCRIPT to clear search text when the field is clicked -->
<script type="text/javascript">
window.onload = function(){
	//Get submit button
	var submitbutton = document.getElementById("tfq");
	//Add listener to submit button
	if(submitbutton.addEventListener){
		submitbutton.addEventListener("click", function() {
			if (submitbutton.value == 'Google Search'){//Customize this text string to whatever you want
				submitbutton.value = 'dnet R ';
			}
		});
	}
}
</script>

<script>
  (function() {
    var cx = '012094530736424854714:djnz9oat1hu';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<div><gcse:search></gcse:search></div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Function to fit a p-value distribution under beta-uniform mixture model</h2>

<div class="row">
  <div class="span8">
  
    <h3>Description</h3>
    <p><code>dBUMfit</code> is supposed to take as input a vector of p-values for
deriving their distribution under beta-uniform mixture model (see Note
below). The density distribution of input p-values is expressed as a
mixture of two components: one for the null hypothesis (the noise
component) and the other for the alternative hypothesis (the signal
component). The noise component is the uniform density, while the
signal component is the remainder of the mixture distribution. It
returns an object of class "BUM".</p>
  
    <h3>Usage</h3>
    <pre>dBUMfit(x, ntry = 1, hist.bum = T, contour.bum = T, verbose = T)</pre>
    
    <h3>Arguments</h3>
    <dl>
      <dt>x</dt>
      <dd>a vector containing input p-values</dd>
      <dt>ntry</dt>
      <dd>an integeter specifying how many trys are used to find the
optimised parameters by maximum likelihood estimation</dd>
      <dt>hist.bum</dt>
      <dd>logical to indicate whether the histogram graph should
be drawn</dd>
      <dt>contour.bum</dt>
      <dd>logical to indicate whether a contour plot should be
drawn to show the log likelihood as a function of two parameters (a and
lambda) in the beta-uniform mixture model</dd>
      <dt>verbose</dt>
      <dd>logical to indicate whether the messages will be
displayed in the screen. By default, it sets to true for display</dd>
    </dl>
    <!-- 
    -->
    
    <!-- 
    <div class="Value">
    -->
      <h3>Value</h3>
      
      <p>an object of class "BUM", a list with following elements:
<ul>
<li><code>lambda</code>: estimated mixture parameter
</li>
<li><code>a</code>: estimated shape parameter
</li>
<li><code>NLL</code>: Negative log-likelihood
</li>
<li><code>pvalues</code>: the input pvalues
</li>
<li><code>call</code>: the call that produced this result
</li>
</ul></p>
      <p></p>
    <!-- 
    </div>
    -->
    <!-- 
    <div class="Note">
    -->
      <h3>Note</h3>
      
      <p>The probability density function of p-values under the Beta-Uniform
Mixture model is formulated as: <code class = 'eq'>f(x|\lambda,a) = \lambda +
(1-\lambda)*a*x^{a-1}</code>. The model names after mixing two distributions:
<ul>
<li>the uniform distribution with the density function as
<code class = 'eq'>\frac{1}{b-a}|_{a=0}^{b=1}=1</code>
</li>
<li>the beta distribution with the density function as
<code class = 'eq'>\frac{\Gamma(a+b)}{\Gamma(a)+\Gamma(b)}*x^{a-1}*(1-x)^{b-1}|_{b=1}=a*x^{a-1}</code>
</li>
</ul></p>
      <p>Both are mixed via <code class = 'eq'>\lambda</code>. The mixture parameter <code class = 'eq'>\lambda</code>
measures the contribution from the uniform distribution. Accordingly,
<code class = 'eq'>1-\lambda</code> measures the contribution from the beta distribution.
Notably, the probability density function of the beta distribution can
be splitted into two parts (rather than the exclusitive signal):
<ul>
<li>the constant part as noise: <code class = 'eq'>a*x^{a-1}|_{x=1}=a</code>
</li>
<li>the rest part as signal: <code class = 'eq'>a*(x^{a-1}-1)</code>
</li>
</ul></p>
      <p>In other words, there is no signal at <code class = 'eq'>x=1</code> but all being noise. It
is a conservative, upper bound estimation of the noise. Therefore, the
probability density function in the model can be decomposed into
signal-noise components:
<ul>
<li>the signal component: <code class = 'eq'>(1-\lambda)*a*(x^{a-1}-1)</code>
</li>
<li>the noise component: <code class = 'eq'>\lambda + (1-\lambda)*a</code>
</li>
</ul></p>
      <p>It is misleading to simply view <code class = 'eq'>\lambda</code> as the noise component
and <code class = 'eq'>(1-\lambda)*a*x^{a-1}</code> as the signal component, just as
wrongly do in the literatures (e.g.
<a href = 'http://www.ncbi.nlm.nih.gov/pubmed/18586718'>http://www.ncbi.nlm.nih.gov/pubmed/18586718</a>)</p>
    <!-- 
    </div>
    -->
    
    <h3 id="examples">Examples</h3>
    <pre class="examples"><div class='input'># 1) generate an vector consisting of random values from beta distribution
x <- rbeta(1000, shape1=0.5, shape2=1)

# 2) fit a p-value distribution under beta-uniform mixture model
fit <- dBUMfit(x)
</div>
<strong class='message'>	A total of p-values: 1000</strong>
<strong class='message'>	Maximum Log-Likelihood: 346.6</strong>
<strong class='message'>	Mixture parameter (lambda): 0.025</strong>
<strong class='message'>	Shape parameter (a): 0.475</strong>
<a href="javascript:newWin('dBUMfit-6.png', 'dBUMfit-6.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='dBUMfit-6.png', width="400" /></a>
<div class='input'>fit$lambda
</div>
<div class='output'>[1] 0.02458494
</div>
<div class='input'>fit$a
</div>
<div class='output'>[1] 0.4749993
</div></pre>
  </div>
  
  <div class="span4">
    
    <!-- 
    <ul>
      <li>dBUMfit</li>
    </ul>
    <ul>
      
    </ul> 
    -->
    
    <h2>Source code</h2>
    <a href="javascript:newWin('R/dBUMfit.r', 'R/dBUMfit.r', '1200', '1200')" title="Click to view"><B><code>dBUMfit.r</code></B></a>
    
    <h2>See also</h2>
    
<code><a href='dBUMscore.html'>dBUMscore</a></code>

    <!--

    <h2>Citation</h2>
    <p>Fang H, Gough J. (2014) <B>The &#39;dnet&#39; approach promotes emerging research on cancer patient survival</B>. <I>Genome Medicine</I> 6:64 (<a href="http://dx.doi.org/10.1186/s13073-014-0064-8">doi:10.1186/s13073-014-0064-8</a>)</p>

<p>You may also cite the package as:</p>

<ul>
<li><code>web link/URL</code></li>
</ul>

<p>Package &ldquo;dnet&rdquo; [<a href="http://cran.r-project.org/package=dnet">http://cran.r-project.org/package=dnet</a>]</p>

    
    
    <h2>URL</h2>
    <ul>
      <li><a href="http://supfam.org/dnet">http://supfam.org/dnet</a></li>
    </ul>
    
    
    -->
    
  </div>
  
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@cs.bris.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>