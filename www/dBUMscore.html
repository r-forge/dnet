<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>dBUMscore @ dnet 1.0.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dnet 1.0.0</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Function to transform p-values into scores according to the fitted beta-uniform mixture model and/or after controlling false discovery rate</h2>

<div class="row">
  <div class="span8">
  
    <h3>Description</h3>
    <p><code>dBUMscore</code> is supposed to take as input a vector of
p-values, which are transformed into scores according to
the fitted beta-uniform mixture model. Also if the FDR
threshold is given, it is used to make sure that p-values
below this are considered significant and thus scored
positively. Instead, those p-values above the given FDR are
considered insigificant and thus scored negatively.</p>
  
    <h3>Usage</h3>
    <pre>dBUMscore(fit, method = c("pdf", "cdf"), fdr = NULL, scatter.bum = T)</pre>
    
    <h3>Arguments</h3>
    <dl>
      <dt>fit</dt>
      <dd>an object of class "BUM"</dd>
      <dt>method</dt>
      <dd>the method used for the transformation. It
can be either "pdf" for the method based on the
probability density function of the fitted model, or
"cdf" for the method based on the cumulative distribution
function of the fitted model</dd>
      <dt>fdr</dt>
      <dd>the given FDR threshold. By default, it is set
to NULL, meaning there is no constraint. If given, those
p-values with the FDR below this are considered
significant and thus scored positively. Instead, those
p-values with the FDR above this given FDR are considered
insigificant and thus scored negatively</dd>
      <dt>scatter.bum</dt>
      <dd>logical to indicate whether the
scatter graph of scores against p-values should be drawn.
Also indicated is the p-value (called tau) corresponding
to the given FDR threshold (if any)</dd>
    </dl>
    <!-- 
    -->
    
    <div class="Value">
      <h3>Value</h3>
      
      <p><ul>
<li><code>scores</code>: a vector of scores </li>
</ul></p>
      <p></p>
    </div>
    <div class="Note">
      <h3>Note</h3>
      
      <p>The transformation from the input p-value <code class = 'eq'>x</code> to the
score <code class = 'eq'>S(x)</code> is based on the fitted beta-uniform
mixture model with two parameters <code class = 'eq'>\lambda</code> and
<code class = 'eq'>a</code>: <code class = 'eq'>f(x|\lambda,a) = \lambda +
(1-\lambda)*a*x^{a-1}</code>. Specifically, it considers the
log-likehood ratio between the signal and noise compoment
of the model. The probability density function (pdf) of the
signal component and the noise component are
<code class = 'eq'>(1-\lambda)*a*(x^{a-1}-1)</code> and <code class = 'eq'>\lambda +
(1-\lambda)*a</code>, respectively. Accordingly, the cumulative
distribution function (cdf) of the signal component and the
noise component are <code class = 'eq'>\int_0^x (1-\lambda)*a*(x^{a-1}-1)
\, \mathrm{d}x</code> and <code class = 'eq'>\int_0^x \lambda+(1-\lambda)*a \,
\mathrm{d}x</code>. In order to take into account the
significance of the p-value, the <code class = 'eq'>fdr</code> threshold is
also used for down-weighting the score. According to how to
measure both components, there are two methods implemented
for deriving the score <code class = 'eq'>S(x)</code>: <ul>
<li>The
method "pdf": <code class = 'eq'>S(x) =
log_2\frac{(1-\lambda)*a*(x^{a-1}-1)}{\lambda+(1-\lambda)*a}
-
log_2\frac{(1-\lambda)*a*(\tau^{a-1}-1)}{\lambda+(1-\lambda)*a}
= log_2\big(\frac{x^{a-1}-1}{\tau^{a-1}-1}\big)</code>. For the
purpose of down-weighting scores, it must ensure
<code class = 'eq'>log_2\frac{(1-\lambda)*a*(\tau^{a-1}-1)}{\lambda+(1-\lambda)*a}
\geq 0 </code>, that is, the constraint via <code class = 'eq'>\tau \leq
\big(\frac{\lambda+2*a*(1-\lambda)}{a*(1-\lambda)}\big)^{\frac{1}{a-1}}</code>
</li>
<li>The method "cdf": <code class = 'eq'>S(x) = log_2\frac{\int_0^x
(1-\lambda)*a*(x^{a-1}-1) \, \mathrm{d}x}{\int_0^x
\lambda+(1-\lambda)*a \, \mathrm{d}x} -
log_2\frac{\int_0^\tau (1-\lambda)*a*(\tau^{a-1}-1) \,
\mathrm{d}x}{\int_0^\tau \lambda+(1-\lambda)*a \,
\mathrm{d}x} =
log_2\frac{(1-\lambda)*(x^{a-1}-a)}{\lambda+(1-\lambda)*a}
-
log_2\frac{(1-\lambda)*(\tau^{a-1}-a)}{\lambda+(1-\lambda)*a}
= log_2\big(\frac{x^{a-1}-a}{\tau^{a-1}-a}\big)</code>. For the
purpose of down-weighting scores, it must ensure
<code class = 'eq'>log_2\frac{(1-\lambda)*(\tau^{a-1}-a)}{\lambda+(1-\lambda)*a}
\geq 0 </code>, that is, the constraint via <code class = 'eq'>\tau \leq
\big(\frac{\lambda+2*a*(1-\lambda)}{1-\lambda}\big)^{\frac{1}{a-1}}</code>
</li>
<li>Where <code class = 'eq'>\tau
=\big[\frac{\lambda+(1-\lambda)*a-fdr*\lambda}{fdr*(1-\lambda)}\big]^{\frac{1}{a-1}}</code>,
i.e. the p-value corresponding to the exact <code class = 'eq'>fdr</code>
threshold. It can be duduced from the definition of the
false discovery rate: <code class = 'eq'>fdr \doteq \frac{\int_0^\tau
\lambda+(1-\lambda)*a \, \mathrm{d}x}{\int_0^\tau
\lambda+(1-\lambda)*a*x^{a-1} \, \mathrm{d}x}</code>. Notably, if
the calculated <code class = 'eq'>\tau</code> exceeds the contraint, it will be
reset to the maximum end of that constraint </li>
</ul></p>
      <p></p>
    </div>
    
    <h3 id="examples">Examples</h3>
    <pre class="examples"><div class='input'># 1) generate an vector consisting of random values from beta distribution
x <- rbeta(1000, shape1=0.5, shape2=1)

# 2) fit a p-value distribution under beta-uniform mixture model
fit <- dBUMfit(x)
</div>
<strong class='message'>	A total of p-values: 1000</strong>
<strong class='message'>	Maximum Log-Likelihood: 402.7</strong>
<strong class='message'>	Mixture parameter (lambda): 0.000</strong>
<strong class='message'>	Shape parameter (a): 0.458</strong>
<a href="javascript:newWin('dBUMscore-6.png', 'dBUMscore-6.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:3px solid #FFFFFF;" src='dBUMscore-6.png', width="400" /></a>
<div class='input'>
# 3) calculate the scores according to the fitted BUM and fdr=0.01
# using "pdf" method
scores <- dBUMscore(fit, method="pdf", fdr=0.01)
</div>
<a href="javascript:newWin('dBUMscore-8.png', 'dBUMscore-8.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:3px solid #FFFFFF;" src='dBUMscore-8.png', width="400" /></a>
<div class='input'># using "cdf" method
scores <- dBUMscore(fit, method="cdf", fdr=0.01)
</div>
<a href="javascript:newWin('dBUMscore-10.png', 'dBUMscore-10.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:3px solid #FFFFFF;" src='dBUMscore-10.png', width="400" /></a></pre>
  </div>
  
  <div class="span4">
    
    <!-- 
    <ul>
      <li>dBUMscore</li>
    </ul>
    <ul>
      
    </ul> 
    -->
      
    <h2>See also</h2>
    
<code><a href='dBUMfit.html'>dBUMfit</a></code>

    
    <h2>Citation</h2>
    <p>Fang H, Gough J. (2014) DNET: dynamic networks via an integrative analysis of network, expression and ontology data. R package version 1.0.0. <a href="http://dnet.r-forge.r-project.org">http://dnet.r-forge.r-project.org</a></p>

    
    <!--
    
    <h2>URL</h2>
    <ul>
      <li><a href="http://dnet.r-forge.r-project.org">http://dnet.r-forge.r-project.org</a></li>
    </ul>
    
    
    -->
    
  </div>
  
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@cs.bris.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>