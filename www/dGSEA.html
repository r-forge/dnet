<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>dGSEA @ dnet 1.0.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dnet 1.0.0</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="rdata.html"><i class="icon-file icon-white"></i> RData</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Function to conduct gene set enrichment analysis given the input data and the ontology in query</h2>

<div class="row">
  <div class="span8">
  
    <h3>Description</h3>
    <p><code>dGSEA</code> is supposed to conduct gene set enrichment
analysis given the input data and the ontology in query. It
returns an object of class "eTerm".</p>
  
    <h3>Usage</h3>
    <pre>dGSEA(data, identity = c("symbol", "entrez"), check.symbol.identity = FALSE, genome = c("Hs", 
  "Mm", "Rn", "Gg", "Ce", "Dm", "Da", "At"), ontology = c("GOBP", "GOMF", "GOCC", 
      "PS", "DO", "HPPA", "HPMI", "HPON", "MP", "MsigdbC1", "MsigdbC2CGP", "MsigdbC2CP", 
      "MsigdbC2KEGG", "MsigdbC2REACTOME", "MsigdbC2BIOCARTA", "MsigdbC3TFT", "MsigdbC3MIR", 
      "MsigdbC4CGN", "MsigdbC4CM", "MsigdbC5BP", "MsigdbC5MF", "MsigdbC5CC", "MsigdbC6", 
      "MsigdbC7"), sizeRange = c(10, 1000), which_distance = NULL, weight = 1, nperm = 100, 
      fast = T, sigTail = c("two-tails", "one-tail"), p.adjust.method = c("BH", "BY", 
          "bonferroni", "holm", "hochberg", "hommel"), verbose = T, RData.location = "http://dnet.r-forge.r-project.org/data")</pre>
    
    <h3>Arguments</h3>
    <dl>
      <dt>data</dt>
      <dd>a data frame or matrix of input data. It must
have row names, either Entrez Gene ID or Symbol</dd>
      <dt>identity</dt>
      <dd>the type of gene identity (i.e. row names
of input data), either "symbol" for gene symbols (by
default) or "entrez" for Entrez Gene ID. The option
"symbol" is preferred as it is relatively stable from one
update to another; also it is possible to search against
synonyms (see the next parameter)</dd>
      <dt>check.symbol.identity</dt>
      <dd>logical to indicate whether
synonyms will be searched against when gene symbols
cannot be matched. By default, it sets to FALSE since it
may take a while to do such check using all possible
synoyms</dd>
      <dt>genome</dt>
      <dd>the genome identity. It can be one of "Hs"
for human, "Mm" for mouse, "Rn" for rat, "Gg" for
chicken, "Ce" for c.elegans, "Dm" for fruitfly, "Da" for
zebrafish, and "At" for arabidopsis</dd>
      <dt>ontology</dt>
      <dd>the ontology supported currently. It can
be "GOBP" for Gene Ontology Biological Process, "GOMF"
for Gene Ontology Molecular Function, "GOCC" for Gene
Ontology Cellular Component, "PS" for phylostratific age
information, "DO" for Disease Ontology, "HPPA" for Human
Phenotype Phenotypic Abnormality, "HPMI" for Human
Phenotype Mode of Inheritance, "HPON" for Human Phenotype
ONset and clinical course, "MP" for Mammalian Phenotype,
and the molecular signatures database (Msigdb) in human
(including "MsigdbC1", "MsigdbC2CGP", "MsigdbC2CP",
"MsigdbC2KEGG", "MsigdbC2REACTOME", "MsigdbC2BIOCARTA",
"MsigdbC3TFT", "MsigdbC3MIR", "MsigdbC4CGN",
"MsigdbC4CM", "MsigdbC5BP", "MsigdbC5MF", "MsigdbC5CC",
"MsigdbC6", "MsigdbC7"). Note: These four ("GOBP",
"GOMF", "GOCC" and "PS") are availble for all
genomes/species; for "Hs" and "Mm", these five ("DO",
"HPPA", "HPMI", "HPON" and "MP") are also supported; all
"Msigdb" are only supported in "Hs". For details on the
eligibility for pairs of input genome and ontology,
please refer to the online Documentations at
<a href = 'http://dnet.r-forge.r-project.org/docs.html'>http://dnet.r-forge.r-project.org/docs.html</a></dd>
      <dt>sizeRange</dt>
      <dd>the minimum and maximum size of members
of each gene set in consideration. By default, it sets to
a minimum of 10 but no more than 1000</dd>
      <dt>which_distance</dt>
      <dd>which distance of terms in the
ontology is used to restrict terms in consideration. By
default, it sets to 'NULL' to consider all distances</dd>
      <dt>weight</dt>
      <dd>type of score weigth. It can be "0" for
unweighted (an equivalent to Kolmogorov-Smirnov, only
considering the rank), "1" for weighted by input gene
score (by default), and "2" for over-weighted, and so on</dd>
      <dt>nperm</dt>
      <dd>the number of random permutations. For each
permutation, gene-score associations will be permutated
so that permutation of gene-term associations is
realised</dd>
      <dt>fast</dt>
      <dd>logical to indicate whether to fast calculate
expected results from permutated data. By default, it
sets to true</dd>
      <dt>sigTail</dt>
      <dd>the tail used to calculate the statistical
significance. It can be either "two-tails" for the
significance based on two-tails or "one-tail" for the
significance based on one tail</dd>
      <dt>p.adjust.method</dt>
      <dd>the method used to adjust
p-values. It can be one of "BH", "BY", "bonferroni",
"holm", "hochberg" and "hommel". The first two methods
"BH" (widely used) and "BY" control the false discovery
rate (FDR: the expected proportion of false discoveries
amongst the rejected hypotheses); the last four methods
"bonferroni", "holm", "hochberg" and "hommel" are
designed to give strong control of the family-wise error
rate (FWER). Notes: FDR is a less stringent condition
than FWER</dd>
      <dt>verbose</dt>
      <dd>logical to indicate whether the messages
will be displayed in the screen. By default, it sets to
false for no display</dd>
      <dt>RData.location</dt>
      <dd>the characters to tell the location
of built-in RData files. By default, it remotely locates
at <a href = '"http://dnet.r-forge.r-project.org/data"'>"http://dnet.r-forge.r-project.org/data"</a>. For
the user equipped with fast internet connection, this
option can be just left as default. But it is always
advisable to download these files locally. Especially
when the user needs to run this function many times,
there is no need to ask the function to remotely download
every time (also it will unnecessarily increase the
runtime). For examples, these files (as a whole or part
of them) can be first downloaded into your current
working directory, and then set this option as:
<code class = 'eq'>RData.location="."</code>. Surely, the location can be
anywhere as long as the user provides the correct path
pointing to (otherwise, the script will have to remote
download each time). Here is the UNIX command for
downloading all RData files (preserving the directory
structure): <code class = 'eq'>wget -r -l2 -A "*.RData" -np -nH
--cut-dirs=0 "http://dnet.r-forge.r-project.org/data"</code></dd>
    </dl>
    <!-- 
    -->
    
    <div class="Value">
      <h3>Value</h3>
      
      <p>an object of class "eTerm", a list with following
components: <ul>
<li><code>set_info</code>: a matrix of
nSet X 4 containing gene set information, where nSet is the
number of gene set in consideration, and the 4 columns are
"setID" (i.e. "Term ID"), "name" (i.e. "Term Name"),
"namespace" and "distance" </li>
<li><code>gs</code>: a list of gene
sets, each storing gene members. Always, gene sets are
identified by "setID" and gene members identified by
"Entrez ID" </li>
<li><code>data</code>: a matrix of nGene X nSample
containing input data in consideration. It is not always
the same as the input data as only those mappable are
retained </li>
<li><code>es</code>: a matrix of nSet X nSample
containing enrichment score, where nSample is the number of
samples (i.e. the number of columns in input data
</li>
<li><code>nes</code>: a matrix of nSet X nSample containing
normalised enrichment score. It is the version of
enrichment score but after being normalised by gene set
size </li>
<li><code>pvalue</code>: a matrix of nSet X nSample
containing nominal p value </li>
<li><code>adjp</code>: a matrix of
nSet X nSample containing adjusted p value. It is the p
value but after being adjusted for multiple comparisons
</li>
<li><code>gadjp</code>: a matrix of nSet X nSample containing
globally adjusted p value in terms of all samples
</li>
<li><code>fdr</code>: a matrix of nSet X nSample containing
false discovery rate (FDR). It is the estimated probability
that the normalised enrichment score represents a false
positive finding </li>
<li><code>qvalue</code>: a matrix of nSet X
nSample containing q value. It is the monotunically
increasing FDR </li>
<li><code>call</code>: the call that produced
this result </li>
</ul></p>
      <p></p>
    </div>
    <div class="Note">
      <h3>Note</h3>
      
      <p>The interpretation of returned components: <ul>
<li>"es": enrichment score for the gene set is the degree
to which this gene set is overrepresented at the top or
bottom of the ranked list of genes in each column of input
data; </li>
<li>"nes": normalised enrichment score for the
gene set is enrichment score that has already normalised by
gene set size. It is comparable across analysed gene sets;
</li>
<li>"pvalue": nominal p value is the statistical
significance of the enrichment score. It is not adjusted
for multiple hypothesis testing, and thus is of limited use
in comparing gene sets; </li>
<li>"adjp": adjusted p value by
Benjamini & Hochberg method. It is comparable across gene
sets; </li>
<li>"gadjp": globally adjusted p value by
Benjamini & Hochberg method. Unlike "adjp", it is adjusted
in terms of all samples; </li>
<li>"fdr": false discovery rate
is the estimated probability that the normalised enrichment
score represents a false positive finding. Unlike "adjp" or
"gadjp" (also aliased as "fdr") that is derived from a list
of p values, this version of fdr is directly calculate from
the statistic (i.e. normalised enrichment score);
</li>
<li>"qvalue": q value is the monotunically increasing FDR
so that the higher "nes", the lower "qvalue". </li>
</ul></p>
      <p></p>
    </div>
    
    <h3 id="examples">Examples</h3>
    <pre class="examples"><div class='input'>load(url("http://dnet.r-forge.r-project.org/data/Datasets/Hiratani_TableS1.RData"))
data <- RT[1:1000,1:2]
eTerm <- dGSEA(data, identity="symbol", genome="Mm", ontology="MP",
which_distance=c(1,2))
</div>
<strong class='message'>Start at 2014-04-09 12:20:19</strong>
<strong class='message'></strong>
<strong class='message'>First, load the ontology MP and its gene associations in the genome Mm (2014-04-09 12:20:19) ...</strong>
<strong class='message'>	Load Enterz Gene information from http://dnet.r-forge.r-project.org/data/Mm/org.Mm.eg.RData</strong>
<strong class='message'>	Load annotation information from http://dnet.r-forge.r-project.org/data/Mm/org.Mm.egMP.RData</strong>
<strong class='message'>Then, do mapping based on symbol (2014-04-09 12:20:21) ...</strong>
<strong class='message'>	Among 1000 symbols of input data, there are 853 mappable via official gene symbols but 147 left unmappable</strong>
<strong class='message'>Third, perform GSEA analysis (2014-04-09 12:20:23) ...</strong>
<strong class='message'>	Sample 1 is being processed at (2014-04-09 12:20:23) ...</strong>
<strong class='message'>		 81 of 81 gene sets have been processed</strong>
<strong class='message'>	Sample 2 is being processed at (2014-04-09 12:20:24) ...</strong>
<strong class='message'>		 81 of 81 gene sets have been processed</strong>
<strong class='message'>
End at 2014-04-09 12:20:26</strong>
<strong class='message'>Runtime in total is: 7 secs
</strong>
<div class='input'>res <- dGSEAview(eTerm, which_sample=1, top_num=5, sortBy="adjp",
decreasing=FALSE, details=TRUE)
visGSEA(eTerm, which_sample=1, which_term=rownames(res)[1])
</div>
<a href="javascript:newWin('dGSEA-17.png', 'dGSEA-17.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='dGSEA-17.png', width="400" /></a>
<div class='input'>output <- dGSEAwrite(eTerm, which_content="gadjp", which_score="gadjp",
filename="eTerm.txt")
</div>
<strong class='message'>A file called eTerm.txt has been successfully written!
</strong></pre>
  </div>
  
  <div class="span4">
    
    <!-- 
    <ul>
      <li>dGSEA</li>
    </ul>
    <ul>
      
    </ul> 
    -->
      
    <h2>See also</h2>
    
<code><a href='dGSEAview.html'>dGSEAview</a></code>, <code><a href='dGSEAwrite.html'>dGSEAwrite</a></code>,
<code><a href='visGSEA.html'>visGSEA</a></code>

    
    <h2>Citation</h2>
    <p>Fang H, Gough J. (2014) DNET: dynamic networks via integrative analysis of network, expression, evolution and ontology data. R package version 1.0.0. <a href="http://dnet.r-forge.r-project.org">http://dnet.r-forge.r-project.org</a></p>

    
    <!--
    
    <h2>URL</h2>
    <ul>
      <li><a href="http://dnet.r-forge.r-project.org">http://dnet.r-forge.r-project.org</a></li>
    </ul>
    
    
    -->
    
  </div>
  
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@cs.bris.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>